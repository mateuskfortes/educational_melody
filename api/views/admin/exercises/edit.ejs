<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <title>Editar Exercício</title>
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/header.css">
</head>
<body>
    <%- include('../../components/header') %>
    <main style="max-width:600px;margin:2rem auto;">
        <h1>Editar Exercício</h1>
        <form action="/admin/exercises/<%= exercise.id %>/edit" method="POST" enctype="multipart/form-data" style="background:#fff;padding:2rem;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.05);">
            <label for="content">Enunciado:</label>
            <textarea id="content" name="content" rows="4" required style="width:100%;margin-bottom:1rem;"><%= exercise.content %></textarea>

            <label for="image">Imagem (opcional):</label>
            <% if (exercise.image) { %>
                <div style="margin-bottom:1rem;">
                    <img src="/uploads/<%= exercise.image.name %>" alt="Imagem do exercício" style="max-width:200px;display:block;">
                    <span style="font-size:0.9em;">Imagem atual</span>
                </div>
            <% } %>
            <input type="file" id="image" name="image" accept="image/*" style="margin-bottom:1rem;">

            <h3>Alternativas</h3>
            <% if (exercise.alternatives && exercise.alternatives.length > 0) { %>
                <% exercise.alternatives.forEach(function(alt, i) { %>
                    <div style="margin-bottom:10px;">
                        <input type="text" name="alternatives[<%= i %>][content]" value="<%= alt.content %>" required>
                        <label>
                            <input type="radio" name="correct" value="<%= i %>" <%= alt.is_correct ? 'checked' : '' %> >
                            Correta
                        </label>
                    </div>
                <% }) %>
            <% } else { %>
                <% for(let i=0; i<4; i++) { %>
                    <div style="margin-bottom:10px;">
                        <input type="text" name="alternatives[<%= i %>][content]" placeholder="Texto da alternativa" required>
                        <label>
                            <input type="radio" name="correct" value="<%= i %>" <%= i === 0 ? 'checked' : '' %> >
                            Correta
                        </label>
                    </div>
                <% } %>
            <% } %>

            <button type="submit" style="margin-top:1rem;padding:10px 20px;background:#ef6257;color:#fff;border:none;border-radius:6px;font-weight:bold;">Salvar</button>
        </form>
    </main>
    <% var exercise = typeof exercise !== 'undefined' ? exercise : undefined; %>
</body>
</html>